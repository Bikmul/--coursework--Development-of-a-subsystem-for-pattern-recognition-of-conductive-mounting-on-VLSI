Разработка подсистемы распознования рисунка проводящего монтажа на послойный чертежах печатных плат
Данный код реализует простую функцию для обнаружения объектов на изображении с использованием предобученной модели Faster R-CNN на базе ResNet-50. последовательность действий:

Импортировать необходимые библиотеки, такие как Pillow (PIL), Matplotlib, Torch и OpenCV.

Загрузить предобученную модель Faster R-CNN ResNet-50 из библиотеки torchvision.models и установить ее в режиме оценки (evaluation mode) с помощью model.eval().

Задать список классов объектов COCO_INSTANCE_CATEGORY_NAMES, которые модель может распознавать.

Определить две функции:

a. get_prediction(): Эта функция принимает путь к изображению и пороговое значение (threshold) для вероятности предсказания. Она загружает изображение, применяет преобразование к тензору, передает изображение через модель, извлекает классы объектов, координаты ограничивающих рамок (bounding boxes) и оценки вероятности предсказания. Затем фильтрует результаты на основе порогового значения и возвращает отфильтрованные классы и ограничивающие рамки.

b. object_detection_api(): Эта функция принимает путь к изображению, пороговое значение, толщину ограничивающих рамок (rect_th), размер текста для классов объектов (text_size) и толщину текста (text_th). Внутри этой функции вызывается get_prediction() для получения предсказанных классов и ограничивающих рамок, затем она рисует ограничивающие рамки и текстовую метку для каждого обнаруженного объекта на изображении и отображает полученное изображение с помощью Matplotlib.

На последней строке кода приведен пример использования функции object_detection_api() для обнаружения объектов на изображении 'Hasty_Founders.jpg' с пороговым значением 0.8.

Если у вас есть изображения, которые вы хотите проверить на обнаружение объектов, вы можете изменить путь к файлу на нужный вам. Кроме того, вы можете настроить пороговое значение (threshold) в вызове функции object_detection_api() для изменения уровня уверенности (вероятности) для вывода предсказанных объектов.
